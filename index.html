<html>
<head>
    <title>Bacterial Simulation</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Javascript Libraries -->
    <script src="bower_components/jquery/jquery.min.js"></script>
    <script src="bower_components/d3/d3.min.js"></script>
    <script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="node_modules/lodash/lodash.js"></script>
    <script src="node_modules/random/random.js"></script>
    <!-- CSS Libraries -->
    <link rel="stylesheet" type="text/css" href="bower_components\bootswatch\cerulean\bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="bower_components\font-awesome\css\font-awesome.css">

    <!-- Application Javascript -->
    <!--<script type="text/javascript" src="js/model.js"></script>-->
    <script type="text/javascript" src="coffee/model.js"></script>
    <script src="js/main.js"></script>
    <!-- Application CSS -->
    <style type="text/css">
    body {
        font-family:"FontAwesome";
        margin-left: -20px;
        margin-top: -20px;
    }
    circle {
        fill: rgb(31, 119, 180);
        fill-opacity: .25;
        stroke: rgb(31, 119, 180);
        stroke-width: 1px;
    }
    svg {
        border: 1px solid grey;
        border-radius: 3px;
        background: lightgrey;
    }

    .siderophore{
        fill: green !important;
    }

    .bound-siderophore{
        fill: orange !important;
    }

    .seeker{
        fill: red !important;
        stroke: darkred;
    }

    .seeker.iron-consumer{
        fill: grey !important;
        stroke: black !important;
    }

    .starving{
        fill: purple !important;
    }

    .selected{
        stroke-width: 5px !important;
    }

    </style>
    <!-- On-Ready Hook -->
    <script>

    function updateStatusTable(){
        var statusTable = d3.select('#seeker-status');
        var rows = statusTable.selectAll('tr').data(arena.actors)
        rows.enter().append("tr")
        rows.attr('class', function(d){return d.selected ? 'info' : ''})
        .on("click", clickSeekerHandler)
        var cells = rows.selectAll('td').data(function(row){
            var vals = [{col:'ID', value: row.id}, {col:"Total Food", value: row.totalFood.toPrecision(5)}, {col:'Age', value: row.age}]
            return vals
        })
        cells.enter().append('td')
        cells.text(function(d){return d.value})
        rows.exit().remove()
    }

    $(function() {
        main("#simulation-container", 0, 5, 25)
        var running = true
        $('#toggle-running-btn').click(function() {
            var handle = $(this)
            if (running) {
                timeManager.pauseSimulation()
                handle.text("Resume simulation")
                running = false
            } else {
                timeManager.startSimulation()
                handle.text("Pause simulation")
                running = true
            }
        })
        updateStatusTable()
        setInterval(updateStatusTable, 1000)
        $('#toggle-running-btn').click()
    })
    </script>
</head>

<body class='container'>
    <div class="row">
        <div id='header'>
            <h1>Bacterial Simulation 
                <small>Dynamic Spatial Evolution</small>
            </h1>
        </div>
    </div>
    <div class="row">
        <div class='col-md-8' id="simulation-container">
        </div>
        <div class='col-md-4' id='control-container'>
            <div class='clearfix'>
                <button id="toggle-running-btn" class='btn btn-primary btn' data-running=true style='margin: 10px; float:left;'>Pause simulation</button>
                <button id="toggle-food-button" class='btn btn-primary' style='margin: 10px; float:left;'>Food Dropper</button>
            </div>
            <table class='table table-bordered'>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Total Food</th>
                        <th>Age</th>
                    </tr>
                </thead>
                <tbody id='seeker-status' ></tbody>
            </table>

        </div>
    </div>
    <div class='row'>
        <div class='col-md-6'>
            Metabolite diffusion visualized as a random walk in two dimensions.
        </div>
    </div>
</body>

</html>
